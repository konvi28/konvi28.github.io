<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABClock Online - Obariv</title>
    <style>
        /* –°—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è –∑–≥—ñ–¥–Ω–æ –∑ activity_main.xml —Ç–∞ MainActivity.kt */
        :root {
            --bg-color: #1a1a2e;
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --time-color: #00d9ff;
            --lesson-bg: #3d5187;
            --lesson-active: #049715;
            --break-active: #a68f14;
            --title-bg: rgba(0, 0, 0, 0.4);
        }

        body {
            margin: 0;
            padding: 20px 14px;
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Segoe UI', Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
            overflow-x: hidden;
        }

        #schoolTitle {
            font-size: 24px;
            margin-top: 20px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
        }

        .logo-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            min-height: 120px;
        }

        #schoolLogo {
            max-height: 150px;
            max-width: 150px;
            object-fit: contain;
        }

        .clock-block {
            flex: 1.8;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-top: 20px;
        }

        #timeTextView {
            font-size: 80px;
            color: var(--time-color);
            background-color: var(--title-bg);
            padding: 10px 40px;
            border-radius: 100px;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 10px;
        }

        #dateTextView {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        #currentEventTextView {
            font-size: 20px;
            color: var(--lesson-active);
            font-weight: bold;
            margin-bottom: 15px;
        }

        .schedule-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥ */
        .schedule-scroll {
            width: 100%;
            overflow-x: auto;
            white-space: nowrap;
            padding: 10px 0;
            -webkit-overflow-scrolling: touch;
            display: flex;
            justify-content: center;
        }

        .schedule-scroll::-webkit-scrollbar {
            display: none;
        }

        .schedule-content {
            display: inline-flex;
            gap: 4px;
            align-items: center;
            padding: 4px;
        }

        .lesson-item {
            background-color: var(--lesson-bg);
            width: 75px;
            height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            font-size: 13px;
            transition: background-color 0.3s;
        }

        .break-item {
            width: 35px;
            text-align: center;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .active-lesson {
            background-color: var(--lesson-active) !important;
        }

        .active-break {
            color: var(--break-active) !important;
            font-weight: bold;
        }

        /* –†—É—Ö–æ–º–∏–π —Ä—è–¥–æ–∫ */
        #marqueeContainer {
            width: 100%;
            background-color: var(--title-bg);
            border-radius: 20px;
            padding: 12px;
            margin-top: 20px;
            overflow: hidden;
            box-sizing: border-box;
        }

        #marqueeTextView {
            font-size: 16px;
            white-space: nowrap;
        }

        .footer {
            margin-top: 20px;
            color: #808080;
            font-size: 12px;
        }
    </style>
</head>
<body>

    <div id="schoolTitle">–ù–∞–∑–≤–∞ –∑–∞–∫–ª–∞–¥—É</div>

    <div class="logo-container">
        <img id="schoolLogo" src="https://via.placeholder.com/150?text=LOGO" alt="School Logo">
    </div>

    <div class="clock-block">
        <div id="timeTextView">00:00</div>
        <div id="dateTextView">01 –°—ñ—á–Ω—è 2025, –ü–æ–Ω–µ–¥—ñ–ª–æ–∫</div>
        <div id="currentEventTextView">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
        <div class="schedule-title">üìö –†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤</div>
    </div>

    <div class="schedule-scroll">
        <div class="schedule-content" id="scheduleContent">
            </div>
    </div>

    <div id="marqueeContainer">
        <marquee id="marqueeTextView" scrollamount="5">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...</marquee>
    </div>

    <div class="footer">–†–æ–∑—Ä–æ–±–Ω–∏–∫ Obariv by Krasovskiy</div>

    <script>
        // –î–∞–Ω—ñ –ø—Ä–æ —É—Ä–æ–∫–∏ –∑ MainActivity.kt
        const lessonTimes = [
            { id: 1, start: "09:00", end: "09:45" },
            { id: 2, start: "09:55", end: "10:40" },
            { id: 3, start: "11:00", end: "11:45" },
            { id: 4, start: "12:00", end: "12:45" },
            { id: 5, start: "13:00", end: "13:45" },
            { id: 6, start: "13:50", end: "14:35" },
            { id: 7, start: "14:40", end: "15:25" },
            { id: 8, start: "15:30", end: "16:15" }
        ];

        let timeOffset = 0; // –†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ —Å–∏—Å—Ç–µ–º–Ω–∏–º —á–∞—Å–æ–º —Ç–∞ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-—á–∞—Å–æ–º

        // 1. –û—Ç—Ä–∏–º–∞–Ω–Ω—è —á–∞—Å—É –∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É
        async function syncWithInternetTime() {
            try {
                const response = await fetch('https://worldtimeapi.org/api/timezone/Europe/Kyiv');
                const data = await response.json();
                const internetTime = new Date(data.datetime).getTime();
                const localTime = new Date().getTime();
                timeOffset = internetTime - localTime;
                console.log("–ß–∞—Å —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–æ. –ó–º—ñ—â–µ–Ω–Ω—è: " + timeOffset + "ms");
            } catch (e) {
                console.error("–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ —á–∞—Å –∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–∏—Å—Ç–µ–º–Ω–∏–π.");
            }
        }

        function getNow() {
            return new Date(new Date().getTime() + timeOffset);
        }

        // 2. –õ–æ–≥—ñ–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≥–æ–¥–∏–Ω–Ω–∏–∫–∞ —Ç–∞ —Å—Ç–∞—Ç—É—Å—ñ–≤
        function updateUI() {
            const now = getNow();
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —á–∞—Å—É
            const timeStr = now.toLocaleTimeString('uk-UA', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('timeTextView').innerText = timeStr;

            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞—Ç–∏
            const dateStr = now.toLocaleDateString('uk-UA', { 
                day: '2-digit', month: 'long', year: 'numeric', weekday: 'long' 
            });
            document.getElementById('dateTextView').innerText = dateStr;

            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            let status = "–£—Ä–æ–∫–∏ –Ω–µ —Ç—Ä–∏–≤–∞—é—Ç—å";
            let activeLessonId = -1;
            let activeBreakId = -1;

            // –•–≤–∏–ª–∏–Ω–∞ –º–æ–≤—á–∞–Ω–Ω—è (09:00)
            if (now.getHours() === 9 && now.getMinutes() === 0) {
                status = "üïØÔ∏è –•–≤–∏–ª–∏–Ω–∞ –º–æ–≤—á–∞–Ω–Ω—è";
                document.getElementById('currentEventTextView').style.color = "#FFDD44";
            } else {
                document.getElementById('currentEventTextView').style.color = "var(--lesson-active)";
                
                // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —É—Ä–æ–∫—ñ–≤
                lessonTimes.forEach((lesson, index) => {
                    const [sH, sM] = lesson.start.split(':').map(Number);
                    const [eH, eM] = lesson.end.split(':').map(Number);
                    const startTotal = sH * 60 + sM;
                    const endTotal = eH * 60 + eM;

                    if (currentMinutes >= startTotal && currentMinutes < endTotal) {
                        status = `–¢—Ä–∏–≤–∞—î ${lesson.id} —É—Ä–æ–∫`;
                        activeLessonId = lesson.id;
                    }

                    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–µ—Ä–µ—Ä–≤
                    if (index < lessonTimes.length - 1) {
                        const nextLesson = lessonTimes[index + 1];
                        const [nsH, nsM] = nextLesson.start.split(':').map(Number);
                        const nextStartTotal = nsH * 60 + nsM;
                        
                        if (currentMinutes >= endTotal && currentMinutes < nextStartTotal) {
                            status = "–¢—Ä–∏–≤–∞—î –ø–µ—Ä–µ—Ä–≤–∞";
                            activeBreakId = lesson.id;
                        }
                    }
                });
            }

            document.getElementById('currentEventTextView').innerText = status;
            renderSchedule(activeLessonId, activeBreakId);
        }

        // 3. –í—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É
        function renderSchedule(activeLessonId, activeBreakId) {
            const container = document.getElementById('scheduleContent');
            container.innerHTML = '';

            lessonTimes.forEach((lesson, index) => {
                // –£—Ä–æ–∫
                const lessonDiv = document.createElement('div');
                lessonDiv.className = `lesson-item ${lesson.id === activeLessonId ? 'active-lesson' : ''}`;
                lessonDiv.innerHTML = `<b>${lesson.id}</b><span>${lesson.start}</span><span>${lesson.end}</span>`;
                container.appendChild(lessonDiv);

                // –ü–µ—Ä–µ—Ä–≤–∞
                if (index < lessonTimes.length - 1) {
                    const nextLesson = lessonTimes[index + 1];
                    const breakDuration = calculateMinutes(nextLesson.start) - calculateMinutes(lesson.end);
                    const breakDiv = document.createElement('div');
                    breakDiv.className = `break-item ${lesson.id === activeBreakId ? 'active-break' : ''}`;
                    breakDiv.innerText = `${breakDuration}\n—Ö–≤`;
                    container.appendChild(breakDiv);
                }
            });
        }

        function calculateMinutes(timeStr) {
            const [h, m] = timeStr.split(':').map(Number);
            return h * 60 + m;
        }

        // 4. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
        async function loadMarqueeText() {
            const url = 'https://api.allorigins.win/get?url=' + encodeURIComponent('https://pastebin.com/raw/9hVaYuZE');
            try {
                const response = await fetch(url);
                const data = await response.json();
                document.getElementById('marqueeTextView').innerText = data.contents;
            } catch (e) {
                document.getElementById('marqueeTextView').innerText = "‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.";
            }
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        syncWithInternetTime();
        setInterval(updateUI, 1000);
        setInterval(syncWithInternetTime, 600000); // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è —Ä–∞–∑ –Ω–∞ 10 —Ö–≤
        loadMarqueeText();
        setInterval(loadMarqueeText, 120000); // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É —Ä–∞–∑ –Ω–∞ 2 —Ö–≤
    </script>
</body>
</html>